DraftversionJanuary4,2022
TypesetusingL
A
T
E
XdefaultstyleinAASTeX631
ImagingtheSun'snear-surfacewsusingmode-couplinganalysis
PrasadMani
,
1
ChrisS.Hanson
,
2
and
ShravanHanasoge
1,2
1
DepartmentofAstronomyandAstrophysics,TataInstituteofFundamentalResearch,Mumbai,India
2
CenterforSpaceScience,NYUADInstitute,NewYorkUniversityAbuDhabi,AbuDhabi,UAE
ABSTRACT
Thetechniqueofnormal-modecouplingisapowerfultoolwithwhichtoseismicallyimagenon-
axisymmetricphenomenaintheSun.HereweapplymodecouplingintheCartesianapproximationto
probesteady,near-surfaceowsintheSun.UsingDopplercubesobtainedfromtheHelioseismicand
MagneticImageronboardtheSolarDynamicsObservatory,weperforminversionsonmode-coupling
measurementstoshowthattheresultingdivergenceandradialvorticitymapsatsupergranularlength
scales(
˘
30Mm)nearthesurfacecompareextremelywellwiththoseobtainedusingtheLocalCorre-
lationTrackingmethod.WethatthePearsoncorrelationcotis

0.9fordivergencews,
while

0.8isobtainedfortheradialvorticity.
Keywords:
Helioseismology(709);Solarphysics(1476);Supergranulation(1662)
1.
INTRODUCTION
HelioseismologyisthestudyoftheSun'sinternalstructureanditsproperties,bymeansofinterpretingits
onsolaroscillations(see
Christensen-Dalsgaard
2002
,forareview).TheseareresonantnormalmodesoftheSun,
behavingasstandingwavesinacavityboundedbythesolarsurfaceandadepththatdependsonthewavenumber
oftheoscillation.Asthesewavespenetratetheinterior,theyregisterinformationofthepropertiesanddynamicsof
thesolarinteriorandreturntothesurface,wheretheyareobserved.TheinternalstructureoftheSuncanthenbe
retrievedthroughmeticulousinversionsoftheseseismicmeasurements.
SeveralimportantwsystemsontheSunhavebeeninferredusingvariousglobalandlocalhelioseismicmethods.
Ofthose,themostnotableglobalhelioseismicresultsincludeinferencesonthesolartialrotation,through
globalmodefrequencysplitting(
Thompsonetal.
1996
;
Schouetal.
1998
),andtheresolvingtheneutrinoproblem
(
Bahcall&Pinsonneault
1992
).Notablelocalhelioseismicresultsincludeimagingofthemeridionalw(
Gilesetal.
1997
;
Gizonetal.
2020
)throughtime-distancehelioseismology(
Duvalletal.
1993
),andfarsideimagingofactive
regions(
Braun&Lindsey
2001
)andtheirnearsideemergence(
Birchetal.
2016
),throughhelioseismicholography
(
Lindsey&Braun
2000
).Therecentdiscoveryofvariousinertialwaves(
Gizonetal.
2021
),includingtheequatorial
Rossbywave(
optienetal.
2018
),hasbeenachievedthroughlocalhelioseismicring-diagramanalysis(
Hill
1988
)and
thenon-helioseismiclocalcorrelationtracking(LCT,
November&Simon
1988
)ofgranulation.
Inrecentyears,theuseofglobalmode-couplinghelioseismology(
Woodard
1989
;
Lavely&Ritzwoller
1992
)has
receivedattention,withmanystudiesseekingtovalidateanddemonstratetheimportanceofsuchatechniquefor
investigatingnumeroussolarphenomena.Whilethederivationofthemode-couplingtechniqueismathematically
challenging,thedataanalysisissimpleandutilizesalltheinformationregisteredbythemode.Thusfar,global
mode-couplinghasbeenvalidatedthroughobservationsofthemeridionalw(
Vorontsov
2011
;
Woodardetal.
2013
),
tialrotation(
Schad&Roth
2020
;
Kashyapetal.
2021
),global-scaleconvection(
Woodard
2014
,
2016
;
Hanasoge
etal.
2020
;
Mani&Hanasoge
2021
)andRossbymodes(
Hanasoge&Mandal
2019
;
Mandal&Hanasoge
2020
;
Mandal
etal.
2021
).Localmode-couplinganalysisintheCartesianapproximation,formulatedby
Woodard
(
2006
),was
validatedby
Hansonetal.
(
2021
)(hereafterH21)byexaminingthepower-spectrumofsupergranularwavesand
comparingwithprevioustime-distancestudies(
Langfellneretal.
2018
).
prasad.subramanian@tifr.res.in
arXiv:2201.00178v1  [astro-ph.SR]  1 Jan 20222
Manietal.
Normal-modecouplingreferstotheconceptofexpressingsolar-oscillationeigenfunctionsasalinearweightedcombi-
nationofmodel-eigenfunctions(e.g.,ModelS
Christensen-Dalsgaard
2021
).Themodeleigenfunctionsformacomplete
andorthogonalbasis.Bydesign,themodelSunissphericallysymmetric,adiabatic,freefromrotation,magnetismand
ws.Inthisstate,theoscillationsareconsideredtobeuncoupled.Theweightsneededtoexpressthesolar-oscillation
eigenfunctionswouldthenencodealltheperturbationsthatareabsentinthemodel.Theforwardproblemthen
reducestorelatingobservedseismicmeasurementstotheperturbationsthatwewanttoinfer.Thesurfacewav
cross-correlationistheprimarymeasurementinthemode-couplinganalysisandcanbedirectlyrelatedtotheweights
(
Woodard
2016
).AsmodecouplingisaFourierdomaintechnique,wavarecross-correlatedattspatial
andtemporalfrequencies,leavinguswithmeasurementssensitivetodierentquantitiesofinterest.
Inthisstudy,weextendthespectralanalysisofH21anddevelopthemethodtoproducenear-surfacewmaps
atsupergranulationlengthscales.ApartoftheformalismthatwasusedtoderivetheforwardmodelinH21is
reworked,primarilytoimagesteadyws.Measurementsarethenconstructed,andinversionstoinferdivergencew
andradialvorticityaredescribed.Wealsodemonstratesignalassociatedwithsupergranularwinaradial-order
coupling(p
2
-p
2
),whichwasnotshowninH21.Thishelpsinlocalizingthemeasurementsensitivitytothesurface.
WecompareourresultswithwsobtainedusingtheLocalCorrelationTrackingmethodonsolargranules.
1.1.
Forwardproblem
Infavorofalgebraicbrevity,weonlyshowcrucialstepshereandrefertheinterestedreadertoAppendix
A
fora
completederivationoftheforwardproblem.Workingintheplane-parallelatmosphere(seealso
Woodard
2006
),we
denotethehorizontalunitvectors
e
x
and
e
y
inourlocalCartesiandomainaspointingtowardswestandnorthonthe
solarsurface,respectively,and
e
z
pointsoutwards.Thisapproximationisvalidwhenobservingpatchesofthesurface
thataresmallwhencomparedtothesolarradius.Whenimagingsteady,near-surfacewsintheneighbourhood
ofthesupergranularscale(
˘
30Mm),weexpectthemeasuredspectralcross-correlationsignaltopeakaroundthe
horizontalwavenumber
qR

ˇ
120(
Rincon&Rieutord
2018
),where
q
=
j
q
j
=
j
(
q
x
;q
y
)
j
isthevectorhorizontal
wavenumberofthew.Accordingly,thegoalistorelatemeasurements(linearly,tofacilitateinversion)tothew
perturbationdescribedinahorizontalFourierdomain.Supergranularvelocitiesaresubsonic(300-400m/s,see
Rincon
&Rieutord
2018
),permittingustomodelthewvector
u
u
u
=(
u
x
;u
y
;u
z
)intheCartesiandomainlikeso(
Unnoetal.
1989
;
Woodard
2006
)
u
˙
=

[

(
P
e
z
)]+

(
T
e
z
)
;
(1)
where
P
=
P
˙
(
x
)and
T
=
T
˙
(
x
)arepoloidalandtoroidalscalarfunctions,varyingwithposition
x
andtemporal
frequency
˙
.
r
isthe3Dgradientoperator.Whilemode-couplingcaneasilybeextendedtostudytime-varying
perturbations(see
Woodard
2016
;
Mani&Hanasoge
2020
;
Hanasogeetal.
2020
;
Mandal&Hanasoge
2020
,for
example),hereweonlyconsiderthefrequencybin
˙
=0,denotingthetemporallyaveragedwovertheperiod
ofanalysis.Wethereforesuppress
˙
fromalltermsthispointforward,rememberingthattemporaldynamicsof
perturbationsmayalsobestudiedusingthesamemodeloutlinedinthefollowingparagraphs.Simplifyingeq
1
using
vectorcalculusresultsin
u
=

r
2
P
e
z
+
r
(
@
z
P
)+
r
h
T

e
z
;
(2)
where
r
h
referstoderivativesonlyinthehorizontaldirection.Mode-couplinghelioseismologyisperformedinthe
Fourierdomain,andsincewewishtoimagehorizontalowsonasmallpatchofthesurface,wedescribethewasa
functionofhorizontalwavenumber
q
anddepth
z
e
z
.Hencethepoloidalandtoroidalwsaredescribedby
P
q
(
z
)and
T
q
(
z
),respectively.Furthermore,weparametrizethewalong
e
z
usingbasisfunctions
f
(
z
)(Chebyshev,
B
-spline,
etc).Thisisexpressedas
P

P
q
(
z
)=
X
j
f
j
(
z
)
P
q
j
;T

T
q
(
z
)=
X
j
f
j
(
z
)
T
q
j
:
(3)
Thewcots
P
q
j
and
T
q
j
,representedbythediscreteindices
q
and
j
,becomeidealcandidatesforinversions,
wherethewforeachwavenumber
q
canbeinvertedforindependently;parallelizationincomputationcanthusbe
exploitedtoexpediteinversions.Notethat
P
q
j
=
P


q
j
and
T
q
j
=
T


q
j
forthewtoberealinthespatio-
temporaldomain.
Toinferwsfromwav
˚
scatteredbyaperturbationoflengthscale
q
,cross-correlatetheminthemanner
Imagingnear-surfaceflowsusingmode-couplinganalysis
3
˚
!

k
˚
!
k
+
q
,where
k
istheoscillationmodewavenumber(
k
x
;k
y
)and
!
isthetemporalfrequency.Relate
˚
!

k
˚
!
k
+
q
thus
tothewcots
P
q
j
and
T
q
j
(seeeq
A7
)
h
˚
!

k
˚
!
k
+
q
i
=
H
!
kk
0
nn
0
X
j
C
q
j;
k
P
q
j
+
D
q
j;
k
T
q
j
:
(4)
Theweightfactor
H
!
(seeeq
A8
)isafunctionoffrequency,capturinginformationabouttheextentofcouplingbetween
thetwomodes[
n;k
]and[
n
0
;k
0
],where
n
and
n
0
aretheradialordersofthemodes,and
k
=
j
k
j
and
k
0
=
j
k
0
j
=
j
k
+
q
j
.
Thespectralofthemode(seeeq
A9
)isapproximatedusingaLorentzian(
Andersonetal.
1990
).Themorethe
Lorentziansofthetwomodesoverlap,thestrongerthecoupling.Finally,therealterms
C
q
j;
k
and
D
q
j;
k
arepoloidal
andtoroidalwsensitivitykernelsrespectively,thatallowustorelatethewsinquestiontothemeasurements
andarederivedfromthesolarmodelseeAppendix
A
.Theypossessthesymmetryrelation:
C
q
j;
k
=
C

q
j;

k
and
D
q
j;
k
=
D

q
j;

k
(seeeq
A6
).Thekernels,asws,areexpressedonthebasis
f
j
(
z
).
1.2.
Least-squaresofcross-correlation
Eventhough
˚
!

k
˚
!
k
+
q
isolatestheofwperturbationsatindividualwavenumbers
q
,amorecompactmea-
surement,knowninmode-couplingliteratureas'
B
-cots',ismuchbetterdesignedforinversionasitreducesthe
dimensionoftheproblem.Aleast-squarestothecross-correlation
˚
!

k
˚
!
k
+
q
(see
Woodard
2006
,
2014
,
2016
)results
inthe
B
-cots
B
k
;
q
,accordingto
B
k
;
q
=
P
!
H
!

kk
0
nn
0
˚
!

k
˚
!
k
+
q
P
!
jH
!
kk
0
nn
0
j
2
:
(5)
Multiplyingeq
4
onbothsidesby
H
!

kk
0
nn
0
andsubstitutingbyeq
5
ontheleft-hand-sideresultsinaconcisely
forwardproblem(comparewitheq
4
)
B
k
;
q
=
X
j
C
q
j;
k
P
q
j
+
D
q
j;
k
T
q
j
:
(6)
Ineq
5
,
Woodard
(
2007
)andH21thusfaronlyconsideredpositive-frequencycomponentsinthesummationover
!
.
Here,wesumoverboth

!
withinafewmodelinewidthsDenotingtheresonantfrequencyofamodeusing
!
nk
,
j
!
j2

!
nk



nk
=
2
;!
nk
+


nk
=
2

or
j
!
j2

!
n
0
k
0



n
0
k
0
=
2
;!
n
0
k
0
+


n
0
k
0
=
2

:
(7)
Summingover

!
guaranteesthattheparity
B
k
;
q
=
B


k
;

q
(seeAppendix
A
forderivation)isobeyed,thereby
ensuringthatthewontheright-hand-sideofeq
6
isarealphysicalquantityinthespatio-temporaldomain.
Takingthecomplexconjugateonbothsidesofeq
6
andconsideringthenegativewavenumbercomponents

q
and

k
,
B


k
;

q
=
X
j
C

q
j;

k
P


q
j
+
D

q
j;

k
T


q
j
:
(8)
Substitutingparityandsymmetryrelationsforalltermsintheaboveresultsineq
6
.As
B
k
;
q
isconstructedbya
least-squaresitisnoteworthythatsummingover

!
willalsoleadtoimprovementinitssignal-to-noiseasa
by-product.
1.3.
Noisemodel
Intheadditiontothesensitivitykernels,asystematicbackgroundnoisemodelisrequiredtoinferthewsfrom
theobserved
B
-cots.Forestimatingthecontributionfromrealizationnoisetothemeasurements,wemakethe
followingassumptions(
Gizon&Birch
2004
):thattheexcitationofthewaveeldismodelledasamultivariateGaussian
randomprocessandthewavareuncorrelatedacrosswavenumberandfrequencyintheabsenceofperturbations.
Everyindependentrealizationofamodecanbeunderstoodastheoutputofadampedharmonicoscillatordrivenbya
randomforcingfunction(see
Duvall&Harvey
1986
).Modesarethusgeneratedwithrandomphasesandamplitudes
andwithlifetimes.Thisstochasticityleadstorealizationnoiseinrepeatedmeasurementsofmodeparameters
4
Manietal.
Figure1.
Dispersionrelationfortheradialordersusedinthisanalysis;f(blue),p
1
(orange)andp
2
(green).Theshaded
regionsofthesamecoloursindicate1-linewidthaboutthemodefrequency.Theyellowshadedregionindicatestherangeof
kR

and
!=
2
ˇ
towhichwehaverestrictedourselvesinthisanalysis.Beyond
kR

of2000,itisseenthatthetheoretical
ofmodefrequenciesstartdeviatingfromtheobserveddispersionrelationforthe
f
-mode.
suchasitsamplitude,frequencyandlinewidth,andconsequentlyin
B
k
;
q
inourcase.Weusethesamenoisemodel
asinH21,whichwasmotivatedbytheabovediscussion,
G
k
;
q
hj
B
k
;
q
j
2
i
;
(9)
where,unlikeH21,weagainsumover

!
.
G
k
;
q
isreal,withthesymmetryrelation
G
k
;
q
=
G

k
;

q
(seeAppendix
A
forexplanation).
2.
DATAANALYSIS
Inordertoexaminenearsurfacewswebuildatime-seriescubeofDopplerimagesthatareobtainedfromthe
HelioseismicMagneticImageraboardtheSolarDynamicsObservatory(HMI/SDO,
Scherreretal.
2012
).Eachimage
isPostelprojected,withaspatialresolutionofapproximately0
:
48Mm,speratedintimeby45seconds,andistracked
atthe(
Snodgrass
1984
)rotationrate.Here,weselectapatchthatis194
:
4

194
:
4Mm
2
insize,trackedfor24hours
andcrossesthedisk-centerinthemiddleofobservationtimeonthe14Novemeber2017(Carringtonrotationnumber
2197,Carringtonlongitude90

).ThisDopplercubeisconsideredasthephysicalwav
˚
(
x;y
;
t
).TheFourier-space
wav
˚
!
k
(andsubsequently,thecross-correlation
˚
!

k
˚
!
k
+
q
)isobtainedbycomputingthe3Dspatialandtemporal
FouriertransformoftheDopplercube.
Thedurationoftheobservedregionislongenoughtoprovidetfrequencybinswithwhichtosumoverin
Eq
6
,whileshortenoughthatsupergranulesdonotsubstantiallyevolve(lifetimeispurportedtobe1.6days;
Rincon
&Rieutord
2018
)overthisperiod.Ourobservationregionisclosetothediskcentertoalsoavoidanycontamination
fromcenter-to-limbsystematics(
Zhaoetal.
2012
;
Langfellneretal.
2015
).
Maximumsignalcanbeextractedfromtheweightedsummationofthecrosscorrelations(eq
5
)whenthespectral
ofthetwomodes[
n;k
]and[
n
0
;k
0
]closelyalignin
!
space.Thisimpliesthattheirmodefrequenciesshouldbe
tlyclose(
j
!
nk

!
n
0
k
0
j

,theseparationparameter).SinceLorentziansdecayrapidly,thesummationover

!
istonlyoverafewlinewidths(

,thesummationparameter;seeeq
7
).Wehaveempiricallyfoundand
tabulated

inTable
1
fortheradialordercouplings
n
-
n
0
2
f-f,p
1
-p
1
,andp
2
-p
2
(thesignalstrengthdependsonly
weaklyon

;wesetitto3linewidths).
Figure
1
showsthatforanytwoadjacentridges(adjacent
n
and
n
0
),modefrequencies
!
nk
and
!
n
0
k
becomespaced
fartherapartwithincreasingwavenumber
kR

.Itisalsoknownthatmodelinewidthgrowswithradialordersfor
agiven
kR

.Moreover,holdingthespatialandtemporalsamplingratesconstant,thespatialsizeanddurationof
observationsetthetotalnumberofmodeswithinarangeof
kR

(and
!=
2
ˇ
)thatcanbeclearlyobserved,thereby
thequalityoftheseismicmeasurements.Owingtothesefactors,tomaximizesignal-to-noise(byvisually
inspectingthepower-spectrum),theparametersdescribingtheextentofcouplingovertrangesof
kR

at
radialorderaret.Inwavenumber,werestrictouranalysistowithin200

kR


2000and
qR


300.Our
frequencyrangeistospantherangeoverwhichacousticmodesareobserved(2

!=
2
ˇ

5inmHz).
Imagingnear-surfaceflowsusingmode-couplinganalysis
5
Coupling
k
R

range#of

modes
f-f
[400,1000]52404
[1000,1500]77841.1
[1500,2000]109400.4
p
1
-p
1
[400,1000]52404.5
[1000,1750]128522
p
2
-p
2
[200,1000]58863
[1000,1300]42803
Table1.
Totalnumberofmodes,andseparationparameter(innumberoflinewidths)fortcouplings,fort
rangesof
kR

.
3.
INVERSION
Thesteptoproducingnear-surfacewmapsinCartesianmode-couplingistoinvertthemeasurements
B
k
;
q
fromthelinearrelationineq
6
.Wedescribeinversionusingregularized-least-squares(RLS)methodhereand
leaveSubtractiveOptimallyLocalizedAverages(SOLA,
Pijpers&Thompson
1994
)forAppendix
B
.Themethods
complementeachother(see
Sekii
1997
),whereRLStriestominimizethebetweendataandmodel,whereas
SOLAgivesbetterlocalization.Fortotalnumberofmodes
M
,RLSscalesas
M
x
J
where
J
isthenumberofbasis
functions
f
j
(
z
)(
J
˝
M
;seeeq
3
andsection
3.1
),whereasSOLAscalesas
M
2
(seeAppendix
B
).For
M>
5000,
computationstartstoquicklybecomeexpensiveforSOLA.
Modeeigenfunctionspeaknearthesurface,withhigherradialorderspossessingsmallerpeaksintheinterior.While
f-fcouplingalonehasenoughsensitivitytoprobeperturbationsatsupergranularscalesclosetosurface,signalis
presenteveninp
1
-p
1
,andp
2
-p
2
(seeFigure
3
),andpossiblyotherhigherorderself-andcross-couplings.Sinceweare
interestedinonlysurfacews,weleavehigherordercouplingtofuturework.
Itbearsmentioningthattheslopesoftheridgesinthe
kR

-

spectrum(Figure
1
)increasewithradialorder.This
limitsustolow-to-intermediate
kR

(
<
1000)forthesehigherradialordersifwearetoremainundertheacousticcut-
frequencyof5.3mHz.Italsobecomesimperativetouseaspatiallylargerobservationpatchtogainaccesstosignals
fromlow
kR

-toolargeanobservationregioncouldpossiblyrenderinvalidtheCartesiangeometryapproximation.
Regardless,inadditiontoperforminginversionsusingallthecouplingsstackedtogether,wealsodemonstrateinversions
separatelyforthethreecouplings(seeTable
2
)inordertoaccountforthefullgamutofmode-couplingasasignal-rich
helioseismictechnique.
3.1.
RLS
Forgiven
q
,theforwardproblemmaybestatedas
KU
=
B
;
(10)
withtheaimtominimizethe
P
k
jj
KU

B
jj
2
,with
jjjj
2
denotingthe
L
2
norm.Here,
K
isthematrixformed
bythesensitivitykernels:
f
C
q
j;
k
;
D
q
j;
k
g
.
U
isavectorcomposedofthewcots:
f
P
q
j
;T
q
j
g
and
B
isavector
composedofcomputed
B
-cots:
f
B
k
;
q
g
.Theleast-squaresproblemissolvedsimultaneouslyforpoloidaland
toroidalw.Weuse
B
-splinebasisfunctionsasour
f
j
(
z
),comprising11knotsspaceduniformlyinacousticradius,
forbothpoloidalandtoroidalcots.Hence,for
M
modes(totalnumberof
k
foragiven
q
is
M
)and11basis
functionsforeachpoloidalandtoroidal,thedimensionsof
K
,
U
and
B
arethus
M

22,22

1,and
M

1respectively.
Normalizingbothsidesofeq
10
bythenoisecovariance

(adiagonalmatrixwiththeentries
G
k
;
q
;seeeq
9
;dimension
M

M
)andpre-multiplyingby
K
|
,
(
K
|


1
K
)
U
=(
K
|


1
)
B
;
(11)
U
=(
K
|


1
K
)

1
K
|


1
B
:
(12)
6
Manietal.
Figure2.
Left
:Averagingkernelforpoloidalw(seesection
B.2
,eq
B17
,andleftpanelofFigure
8
)for
q
R

=[

112
;

45],
atthedepth
z
o
=

0
:
41Mm.
Right
:L-curveforthemode
q
R

=[

112
;

45];theknee(

=2
:
48)ismarkedbyablue
diamond.
Sincetheleast-squaresproblemistypicallyill-posed,werestatetheminimizationas
P
k
jj
KU

B
jj
2
+

jj
U
jj
2
with
theregularizationparameter

whichthisresultsinabetweenreductionterm)andsolution
normminimization(secondterm).Under-regularizingcanleadtoasolution
U
thatisdominatedbyerrorsinthe
dataandontheotherhand,over-regularizingmaysmoothordampthesolutionmorethannecessary.Includingthis
regularizationmakestheproblembetterconditionedandisnowas
U
=(
K
|


1
K
+

I
)

1
K
|


1
B
;
(13)
where
I
istheidentitymatrixfor
L
1
regularization.Theknee-pointofthe
L
-curve(
Hansen
1992
),acurveformed
byplotting
jj
U
jj
2
vs
jj
KU

B
jj
2
fortvaluesof

(seerightpanelofFigure
2
),isusuallychosenasthe
regularizationparameter.Aftersuccessfullyinvertingfor
U
,wereconstructthewusingeq
3
.Resultsforpoloidal
w
P
q
areshowninFigure
3
.
4.
LCT
Toimproveintheimagednear-surfacewsthroughmode-coupling,wecomparethemwithwsobtained
fromLocalCorrelationTrackingmethod(LCT;
November&Simon
1988
).LCTprovideswmapsby
examiningtheadvectionofconvectivegranules(1.2Mm,
qR

ˇ
3500;
Hathawayetal.
2015
)byunderlyinglarger-
scalewsystems.Sincegranulesareusedastracers,whicharemuchsmallerinsizethansupergranules(
ˇ
35Mm),
LCTisanemethod(see
Rieutordetal.
2001
)toproducesurfacehorizontalwmapsofsupergranulation.
TimeseriesofintensityimagesfromHMI,withthesamepropertiesoftheDopplercubesdescribedinsection
2
(trackingrate,date,location,sizeanddurationofobservedpatch,spatialandtemporalsamplingrate),areob-
tainedandPostelprojected.Thehorizontalwsarededucedbytrackingthepropermotionsofgranulesbetween
consecutiveintensityimages,whichwedenoteas
I
1
;
I
2
.TheLCTmethodselectsapatchintwoimageseach
(
I
1
=
I
1
e
(
x

x
ij
)
2
=
2
sigma
2
;I
2
=
I
2
e
(
x

x
ij
)
2
=
2
sigma
2
)thatobservethesamegranuleatthegridpoint
x
ij
=(
x
i
;y
j
).
AGaussianofwidth
sigma
allowstoisolateasmallregionsurroundingthegridpointofinterestasthedistance
movedbygranulesareusuallyinsub-pixelregime.Theconventionforthedirectionof
x
isthesameasdescribedin
section
1.1
.Thetwopatches
I
1
;I
2
arethencrosscorrelatedfortvaluesofpositionshifts
x
,
C
ij

x;

y
)=
Z
d
x
I

1
(

x
)
I
2

x

x
)
:
(14)
Theshift
x
=
x;

y
)thatmaximizesthecross-correlation
C
ij
istakentobethepropermotionofthegranule.
Providedthatthetime
t
,here45seconds,betweentheimagesislessthanthelifetimeofgranules(
<
10
min),thevelocitiesaregivenby
v
x
=
x=

t
and
v
y
=
y=

t
.Thisexerciseisrepeatedforallgridpointsinthe
images
I
1
;
I
2
andforeachconsecutivepairofimagesinthecube.
Inpractice,weusetheFourierLCTalgorithm(FLCT,
Fisher&Welsch
2008
)forcomputing
v
x
and
v
y
.FLCT
requirestheinput
sigma
,whichwesetto4pix,thatcapturestheextentoflocalizationdesired,anddependsonthe
Imagingnear-surfaceflowsusingmode-couplinganalysis
7
Figure3.
Top
:Invertedpoloidalwpower-spectrumforthethreecouplingsf-f,p
1
-p
1
,andp
2
-p
2
asafunctionof
q
x
R

and
q
y
R

.
Bottom
:Correspondingpower-spectrumaveragedovertheazimuthalangle.Shadedregionshows

1
˙
erroraroundthe
mean.Totalpowerappearstoincreasethroughtheradialorders.Powerisinunitsofm
2
/s
4
.
dominantlengthscaleofthevelocityintheimages.ThePostel-projectedintensityimagesarefedasinputtothe
FLCTcode.
v
x
and
v
y
arethencomputedforconsecutivepairsofimagesandareaveragedovertheentireday.
5.
MAPSOFHORIZONTALDIVERGENCEANDRADIALVORTICITY
Formode-coupling,horizontaldivergence(hereafter
div
)andradialvorticity(hereafter
curl
)arecomputedby
substituting
P
and
T
fromeq
3
intoeq
2
asbelow-
u
u
u
(
q
;z
)=

r
2
P
e
z
+
r
(
@
z
P
)+
r
h
T

e
z
;
=

(0
;
0
;@
2
x
P
+
@
2
y
P
+
@
2
z
P
)+(
@
x
@
z
P;@
y
@
z
P;@
2
z
P
)+(
@
y
T;

@
x
T;
0)
:
(15)
Setting
@
2
x
+
@
2
y
=
q
2
,
div
isgivenby,
r
h

u
u
u
(
q
;z
)=
q
2
@
z
P;
(16)
and
curl
isgivenby,
h
r

u
u
u
(
q
;z
)
i
z
=
q
2
T:
(17)
Wefollowsimilarstepstothosetakenin
Langfellneretal.
(
2015
)forcomparisonofwmapswithLCT.The
essentialstepforcomparisonattlengthscalesistobandpasstheFourier-spacewaroundthe
qR

of
interest(seeFigure
4
),andsubsequentlyconvertittorealspace.
Weseektoshowcomparisons(seeFigures
5
,
6
,and
7
)for
qR

=100,150,200and250.Totlydelineate
wsattheselengthscales,weapplyaGaussian(seeFigure
4
)towsobtainedfromeqns
16
and
17
.The
Gaussianiscenteredatthedesiredwavenumberwithahalf-widthof25.Wethenperforma2DFouriertransformto
obtainareal-spacewmap.
8
Manietal.
Figure4.
Left:Divwpowerspectrum
j
div
j
2
,fromeqn
16
,obtainedfrominversionusingallthecouplings.The
power-spectrumisthenwithabandpasscenteredaround
qR

=150(middlepanel).Theresultingspectraisshownin
therightpanel.Theunitsof
j
div
j
2
areins

2
.Forillustration,weshowtheactionoftheonthepower-spectrum
j
div
j
2
sinceitisarealquantity,butrecallthatitistheFourier-spacew
div
(acomplexquantity)onwhichweapplythe
ForLCT,weapplyaGaussiansmoothingto
v
x
and
v
y
toaverageoversmall-scalefeatures;theextentof
smoothingdependsonthelengthscale
qR

tobecomparedwithmode-coupling.
div
and
curl
arethensimply
computedby
div
=
@
x
v
x
+
@
y
v
y
;
(18)
curl
=
@
x
v
y

@
y
v
x
:
(19)
Wethenperforma2DFouriertransformoneqns
18
and
19
,applythesameGaussianasformode-coupling,
andtransformbacktorealspace.
Condensingalloftheabove,thefollowingsequenceofoperationstocomparewsatdesiredlengthscalesare
performedformode-coupling(M-C)andforLCT-
M-C:
˚
(
x;y
;
t
)
3DFFT
=====
)
˚
!
k
;B
k
;
q
inversion
======
)
P;T
r
h

===
)
r

eqns
16
;
17
Filter,
=====
)
2DFFT
div;curl
LCT:
I
1
;
I
2
FLCT
====
)
v
x
;v
y
smooth,
======
)
r
h

r

eqns
18
;
19
2DFFT,
======
)
Filter
Filtered,
Fourier-space
ws
2DFFT
=====
)
div;curl
6.
RESULTS
Table
2
summarizestheresultsofthecomparisonbetweenwsobtainedfrommode-couplingandLCT.Figure
5
,
wherewehaveusedallthecouplingstoperforminversions,showsa97%correlationbetweendivergencewsfrom
thetwomethodsnearsupergranularscale(
qR

ˇ
100).Near-surfacewsareimagedmostfaithfullywhenallthe
couplingsareused.Sincevorticalwsareimagedataregionneartheequator,itispossiblethatthesourceof
vorticityissomethingotherthanCoriolisforce.Nevertheless,thereisalsoaverygoodagreement(87%)between
thevorticalwsasinferredfromthetwomethods,despitebeinganorderofmagnitudeweakerthanthedivergence
ws(thisisconsistentwiththeresultsof
Hathawayetal.
2015
;
Langfellneretal.
2015
;
Rinconetal.
2017
).Dueto
tmodesforthep
2
-p
2
case(seeTable
1
),weareunabletoinfervorticalwswithconvictionotherthannear
thesupergranularscale,ascanbeseenfromTable
2
.Figure
6
alsoalignswithwhatwebelievecanbeaccomplished
throughmode-couplinghelioseismology-usingf-forp
1
-p
1
alonetoseismicallyinfernear-surfacedivergenceandvortical
wsattscales(
qR

=100
;
150)canyieldextremelygoodagreementwithLCT.Asthelengthscaleofthe
inferredwmovesfurtherawayfromthatofsupergranules(Figure
7
),thedemandonsignal-to-noisealsoincreases.
Anadequatenumberofmodes(andcouplingstrengthbetweenhigherradial-orders)thusbecomesanecessityto
commentsubstantivelyonthewsatthesescales.
6.1.
Amplitudesofmode-coupling
Imagingnear-surfaceflowsusingmode-couplinganalysis
9
(a)
qR

=100
;
f-f+p
1
-p
1
+p
2
-p
2
Figure5.
Real-spacedivergencews(leftcolumn,inunitsof10

5
s

1
)andradialvorticity(rightcolumn,inunitsof10

6
s

1
)
forLCT(toprow),andmode-couplinginversionsthroughRLSusingallthecouplings(middlerow),bandpassaround
qR

=100(seeFigure
4
).Correspondingscatterplotsandcorrelationcotsareshowninthebottomrow.Wecutedges
outfromthewmapsandcompareacircularregionofdiameter
ˇ
175Mm.Theslopesoftheblinethroughthescatter
plotsare0.51fordivergenceand0.01forvorticity.Thevorticitywmapsaresaturatedtoshowonly40%ofthemaximum
values.
ForbothLCTandmode-couplingdivergenceandvorticitymaps,numerousfactors,arisingfromtheassociated
numerousdataprocessingsteps,cantheinferenceofwamplitudes,makingittoputforward
aprecisestatementonthem.H21reporteda60%greateramplitudeforp
1
-p
1
overf-fcoupling(Figure
3
a
similarconclusion),anotherelementtoconsiderwhencombiningtradialorders.Thechoiceofregularization
(seerightpanelofFigure
2
)hasthepotentialtotheamplitudesoftheinvertedwstosomedegree.Flow
amplitudesalsovarywithdepth,implyingthattradialordersandLCTwillmeasuretwaverages.
Thisvariabilityemergesasanaturalconsequenceofanyhelioseismicinversionprocedurenecessitatingtheuseofa
radialgridalongwhichkernelsandwstendtobedescribed.
Thus,theamplitudesofthemode-couplingws(andthecorrelationcot)dependuponthefollowingfactors:
‹
Coupling(s)used,
‹
Regularizationparameterintheinversion,
‹
SmoothingappliedtoLCTws(indirectly;seebelowparagraph),
‹
Thedepthatwhichwsareinferred.
Here,wereportinTable
2
onlythemaximumcorrelationfoundfromamongthepointsintheradialgridclose
tothesurface(within

0.5Mmfrom
z
=0).Foradesiredcomparisonlengthscale
qR

,wethecoupling(s)
andtheregularizationparametertobeusedintheinversion.Wethenseparatelycomputedivergenceand
10
Manietal.
(a)
qR

=100
;
f-f
(b)
qR

=150
;
p
1
-p
1
Figure6.
Real-spacedivergencews(leftcolumn,inunitsof10

5
s

1
)andradialvorticity(rightcolumn,inunitsof10

6
s

1
)
forLCT(toprow),andmode-couplinginversionthroughRLSusing(a)f-fcoupling(bottomrow),bandpassaround
qR

=100,andusing(b)p
1
-p
1
coupling(bottomrow),bandpassaround
qR

=150.Wecutedgesoutfromthew
mapsandcompareacircularregionofdiameter
ˇ
175Mm.
(a)
qR

=200
;
f-f+p
1
-p
1
+p
2
-p
2
(b)
qR

=250
;
f-f+p
1
-p
1
+p
2
-p
2
Figure7.
Real-spacedivergencews(leftcolumn,inunitsof10

5
s

1
)andradialvorticity(rightcolumn,inunitsof10

6
s

1
)
forLCT(toprow),andmode-couplinginversionthroughRLSusingallthecouplings(bottomrow),bandpassaround
(a)
qR

=200,and(b)
qR

=250.Wecutedgesoutfromthewmapsandcompareacircularregionofdiameter
ˇ
175Mm.
vorticitymapsforLCTfortvaluesofsmoothing.Thesewmapsarethencomparedwiththoseobtained
frominversionsatalldepthsintheradialgridthatarewithin0.5Mmfromthesurface.Thehighestcorrelation
(correspondingtotheabovedepthsandsmoothing)isnotedandcomparisonwmapsareplottedforthedesired
qR

.
Ithasbeenshown(see
DeRosa&Toomre
2004
;
Langfellneretal.
2015
)thatline-of-sightvelocityfromDopplergrams
andLCTagreecloselyinamplitudes.But,torecapitulate,ahostoffactorsdescribedabovecanskewtheamplitudes
fordivergencewsowingtothemulti-stepprocessinvolvedinobtainingthem.Forexample,therehasbeenahistory
(see,e.g.,
DeRosaetal.
2000
;
Sekiietal.
2007
;
Zhaoetal.
2007
;
Langfellneretal.
2018
;
oningetal.
2020
;
Korda
&

Svanda
2021
)ofusingtravel-timeasonlyaproxyforhorizontaldivergence.However,
Langfellneretal.
Imagingnear-surfaceflowsusingmode-couplinganalysis
11
Coupling
q
R

divcurl
f-f
1000.970.87
+p
1
-p
1
1500.950.76
+p
2
-p
2
2000.920.76
2500.850.65
f-f
1000.960.85
1500.930.76
2000.890.69
2500.770.58
p
1
-p
1
1000.950.83
1500.950.75
2000.920.75
2500.850.61
p
2
-p
2
1000.940.7
1500.910.39
2000.790.3
2500.550.3
Table2.
Correlationbetweenmode-couplingwmapsandLCTmapsderivedfromHMIDopplergramsandintensityimages,
respectively.
(
2015
),
Birchetal.
(
2016
)and
Birchetal.
(
2019
)useempiricallydeterminedconversionfactorstoalignwamplitudes
fromtravel-timemeasurementswiththoseofLCT,whileacknowledgingthatLCTunderestimatesmagnitudes(see
Vermaetal.
2013
;
optienetal.
2016
).Evenforthecaseofsupergranulationdivergencemapsobtainedthrough
ring-diagramhelioseismology,
Greeretal.
(
2016
)onlyreportnormalizedamplitudes.
Inthiswork,wehavedevelopedinversionstoshowthattheCartesianapproximationofmode-couplingcanbeused
withgreatdencetoinvestigatewsnearthesurface.Carefulinversionsofmode-couplingmeasurements,built
usingatlylargemodesetthatpenetratesintothedeeperlayersoftheconvectionzone,canalsoenableprobing
ofthedepthstructureandtime-evolutionofsupergranules,partoffuturework.Withenoughmodestoimprove
signal-to-noisethroughlargerobservationsizes,wesuggestthatCartesianmode-couplingcanlocalhelioseismic
applicationstoinvestigateotherdepth-andtime-varyingfeaturessuchasgiantcellws(see
Hathawayetal.
2013
;
Hansonetal.
2020
),emergingactiveregions,meridionalwsandRossbywaves.
APPENDIX
A.
DERIVATIONOFTHEFORWARDMODEL
Asdescribedinsection
1.1
,weseektodescribethew
u
asafunctionof
q
along
e
z
.Tothatend,substituting
eq
3
intoeq
2
,
u
˙
q
(
z
)=
X
j

q
2
f
j
e
z
+
i
q
f
0
j

P
˙
j
q
+
i
q

e
z
f
j
T
˙
j
q
:
(A1)
Forwsintheanelasticlimit(
u
˝
speedofsound),wecandenotethewperturbationoperatoras

L
˙
=

2
i!ˆ
u
˙

r
(see
Hanasogeetal.
2017
).SubstitutingEq.
A1
intotheoperator,weget,

L
˙
q
=

2
i!ˆ
(
i
u
˙
q

k
+
u
˙
q

e
z
@
z
)
;
(A2)
=

2
i!ˆ
P
j


k

q
f
0
j
P
˙
j
q

k

(
q

e
z
)
f
j
T
˙
j
q
+
q
2
f
j
P
˙
j
q
@
z

:
(A3)
12
Manietal.
ExpressthemodeeigenfunctiondescribingoscillationsintheCartesiandomainby(see
Woodard
2006
)
˘
k

˘
nk
(
z
)=
i
^
k
H
nk
(
z
)
e
z
+^
zV
nk
(
z
)
;
(A4)
where
H
and
V
arereal-valuedfunctions;
n
and
n
0
aredroppedforcompactnessofnotation.Thenthecouplingof
twomodes
˘
k
and
˘
k
0
(
k
0
=
k
+
q
),bythewperturbationoperator

L
˙
q
,denotedbycouplingintegral
k
k
0
(
˙
),is
givenby

k
k
0
(
˙
)

Z
d
x
(

L
˙
q
˘
k
)

˘

k
0
=
Z
d
x
"

2
i!ˆ
X
j
n
q
2
f
j
P
˙
j
q
(
^
k

^
k
0
H
0
k
H

k
0
+
V
0
k
V

k
0
)


k

q
f
0
j
P
˙
j
q
+
k

(
q

e
z
)
f
j
T
˙
j
q

(
^
k

^
k
0
H
k
H

k
0
+
V
k
V

k
0
)
o
#
(A5)
Wedesiretolinearlyrelatethecouplingintegralintheaboveequationtothews
P
and
T
,throughpoloidaland
toroidalsensitivitykernels,
C
q
j;
k
and
D
q
j;
k
respectively.Hence,theyaregivenby
C
q
j;
k
=
Z
d
zˆ
h
q
2
f
j
(
^
k

^
k
0
H
0
k
H

k
0
+
V
0
k
V

k
0
)

k

q
f
0
j
(
^
k

^
k
0
H
k
H

k
0
+
V
k
V

k
0
)
i
;
D
q
j;
k
=
k

(
q

e
z
)
Z
d
zˆf
j
(
^
k

^
k
0
H
k
H

k
0
+
V
k
V

k
0
)
:
(A6)
Notethesymmetry
C
q
j;
k
=
C

q
j;

k
and
D
q
j;
k
=
D

q
j;

k
.Thiscouplingintegralcontributestothecross-spectral
measurementbetweenmodes
k
and
k
+
q
Fromeq8of
Woodard
(
2014
),wewritetheofwon
wavcross-correlationas
h
˚
!

k
˚
!
+
˙
k
+
q
i
=
H
!
kk
0
˙

k
k
0
(
˙
)
;
(A7)
wherethefunction
H
isgivenby
H
!
kk
0
˙
=

2
i!
(
N
k
j
R
!
k
j
2
R
!
+
˙
k
0
+
N
k
0
j
R
!
+
˙
k
0
j
2
R
!

k
)
:
(A8)
Weabsorbthefactor

2
i!
intotheof
H
.Substituteeq
A6
inright-hand-sideofeq
A7
toobtaineq
4
.
Themodespectral
R
isaLorentzian,givenby
R
!
k
=
1
!
2
nk

!
2

i!
nk
=
2
;
(A9)
where
!
nk
istheresonantfrequencyofthemode,and

nk
isthemodelinewidth.Eq
A9
canbederivedbyintroducing
modedamping

i!ˆ
asanoperatorinthetialequationthatgovernsundamped,drivenoscillations(seeeq
5of
Hanasogeetal.
2017
),andthenderivingtheofperturbationstothewavcross-correlation.
Also,theparity
H
!
kk
0
˙
=
H

!

kk
0

˙
and
R
!
k
=
R

!

k
areestablished.Modenormalization
N
isgivenby
N
k
=
1
Q
Q
X
k
P
!
j
˚
!
k
j
2
P
!
R
!
k
;
(A10)
wherethe
1
Q
Q
P
k
ontheright-hand-sideimpliesaverageoverall[
k
x
;k
y
](Qtermsinall)suchthat
k
=
j
k
j
isconstant.
Thisforces
N
tobeisotropic,i.e.,toonlydependon
k
,andnot
k
.Thesumover
!
iswithinelinewidthsof
!
nk
.
NotethatEq.
A8
through
A10
aremofromH21toensureparityandthatowmapsarereal.
Thethreeequations
A8
through
A10
,alongwiththesymmetryrelationforkernels,andsummationover

!
,serve
toestablishtheparity
B
˙
k
;
q
=
B

˙

k
;

q
.Thisallowsforobtaining
P
˙
q
=
P

˙

q
,andsubsequently,purelyrealowin
therealdomain.Setting
˙
=0givesusthelinear,invertibleequationeq
6
.Substitutingeqns
A8
through
A10
into
thenoisemodelobtainedinH21andsummingover

!
establishesthesymmetry
G
˙
k
;
q
=
G

˙

k
;

q
.
Imagingnear-surfaceflowsusingmode-couplinganalysis
13
B.
SOLAINVERSIONS
SubtractiveOptimallyLocalizedAverages(SOLA,
Pijpers&Thompson
1994
)aimstoobtainasetofweightfactors
forthemode
q
anddepth
z
o
,whichwewillcall

k
;zo
.Alinearweightedsumofthemeasurements
B
k
;
q
inthefashion
P
k

k
;zo
B
k
;
q
allowsforanaveragevalueofthew
P
q
(
z
)tobeestimatedatthedepth
z
o
.Toobtainthecots

k
;zo
,itisassumedthatasetofsensitivitykernels
K
k
;
q
(
z
)forthemode
q
canbesummedupcoherentlytogivean
'averagingkernel'thatislocalizedatthedepth
z
o
.Conventionally,aGaussiancenteredat
z
o
andawidthischosen
whichtheaveragingkernelshouldresembleafterperforminginversion.
B.1.
Kernelsintheintegralform
Sincethekernelsineq
A6
aremanifestascotsonabasis
f
j
(
z
),wederivekernelsthatcanbeexpressed
asafunctionofdepth
z
(seeFigure
8
).Itisconvenienttoderiveinmatrixform.Thus,withthefollowings:
P

P
q
(
z
),
p

P
q
j
,
F

f
j
(
z
),
B

B
k
;
q
C

C
q
j;
k
and
K

K
k
;
q
(
z
),wewrite(assumeonlypoloidalwfor
simplicity,thesamederivationsholdtruefortoroidalwaswell)
P
=
Fp
(B11)
Thesizeof
P
isthusthesameasthelengthoftheradialgrid
z
.
Now,pre-multiplyby
F
T
andintegrateover
z
onbothsides(droptheintegralnotationforcompactness),
F
T
P
=(
F
T
F
)
p
p
=(
F
T
F
)

1
F
T
P
(B12)
Now,substitutingeq
B12
intotheforwardproblemeq
6
,
B
=
Cp
=(
F
T
F
)

1
F
T
CP
=
KP
(B13)
where
K
=(
F
T
F
)

1
F
T
C;
i.e.,
K
k
;
q
(
z
)=
X
j;j
0
h
Z
d
zf
j
(
z
)
f
j
0
(
z
)
i

1
f
j
0
(
z
)
C
q
j
0
;
k
(B14)
B.2.
Obtainingtheco

Now,demandthattheaveragingkernelshouldresembleaunimodulustargetGaussiancenteredat
z
o
T
(
z;z
o
)=
1
p
2
ˇ

2
exp

z

z
o

2

:
(B15)
Thiscanbeachievedbysolvingtheoptimizationproblem
minimize
X
=
Z
d
z
h
T
(
z;z
o
)


q
(
z;z
o
)
i
2
;
(B16)
whereweintroducetheaveragingkernelformode
q
thus

q
(
z;z
o
)=
X
k

k
;zo
K
k
;
q
(
z
)
:
(B17)
Asanaside,wenotethataveragingkernelscansimilarlybeconstructedforRLS(seesection
3.1
)usingeqns
13
and
B14
.
14
Manietal.
Figure8.
Left
:Kernel
K
k
;
q
(
z
)(eq
B14
)shownvsdepth
z
forthethreeradialordercouplingsf-f,p
1
-p
1
,andp
2
-p
2
.
q
R

=
[

112
;

45]and
k
R

=[

853
;

157]ischosenforalltheradialordercouplingsforcomparison.
Right
:Averagingkernel
(eq
B17
)usingSOLA,for
q
R

=[

112
;

45]atdepth
z
0
=

0
:
48Mm,andthecorrespondingtargetGaussian(eq
B15
).
Integraloftheaveragingkernelover
z
is0.89.
Setting
@
X
@
!
0givesusthematrixproblemtobesolved
A
f

g
=
v;
f

g
=
h
A
+

i

1
v;
(B18)
wherethesquarematrix
A
=
R
d
zK
k
;
q
(
z
)
K
k
0
;
q
(
z
)and
v
=
R
d
zK
k
;
q
(
z
)
T
(
z;z
o
).Here,
k
0
isjustadummyindexfor
denotingelementsinthematrix
A
,(
k
0
6
=
k
+
q
).Inthelastlineofeq
B18
,weintroduceregularizationusinganIdentity
matrix
I
,withtheregularizationparameter

-purposebeingthesameasthatdescribedinsection
3.1
.Obtaining

thusbecomesahighlyexpensivecomputationallyforverylargenumberofmodes(seesection
3
).Substitute

obtainedfromeq
B18
intolastlineofeq
B13
,and
P
k
onbothsides
X
k

k
;z
o
B
˙
k
;
q
=
X
k

k
;z
o
Z
d
zK
k
;
q
(
z
)
P
˙
q
(
z
)
;
=
Z
d
z

q
(
z;z
o
)
P
˙
q
(
z
)
;
ˇh
P
˙
q
(
z
o
)
i
(B19)
InversionscansimilarlybeperformedformultipledepthsbychoosingsuitablewidthsforthetargetGaussians.Di-
vergencewcanthenbeobtainedfromeq
16
.ResultsareshowninFigures
9
and
10
.
REFERENCES
Anderson,E.R.,Duvall,ThomasL.,J.,&S.M.
1990,ApJ,364,699,doi:
10.1086/169452
Bahcall,J.N.,&Pinsonneault,M.H.1992,Reviewsof
ModernPhysics,64,885,
doi:
10.1103/RevModPhys.64.885
Birch,A.C.,Schunker,H.,Braun,D.C.,etal.2016,
ScienceAdvances,2,e1600557,
doi:
10.1126/sciadv.1600557
Birch,A.C.,Schunker,H.,Braun,D.C.,&Gizon,L.2019,
A&A,628,A37,doi:
10.1051/0004-6361/201935591
oning,V.G.A.,Birch,A.C.,Gizon,L.,Duvall,T.L.,&
Schou,J.2020,A&A,635,A181,
doi:
10.1051/0004-6361/201937331
Braun,D.C.,&Lindsey,C.2001,ApJL,560,L189,
doi:
10.1086/324323
Christensen-Dalsgaard,J.2002,ReviewsofModern
Physics,74,1073,doi:
10.1103/RevModPhys.74.1073
|.2021,LivingReviewsinSolarPhysics,18,2,
doi:
10.1007/s41116-020-00028-3
Imagingnear-surfaceflowsusingmode-couplinganalysis
15
Figure9.
Left
:Poloidalwpower-spectrumforf-fasafunctionof
q
x
R

and
q
y
R

.
Right
:Correspondingpower-spectrum
averagedovertheazimuthalangle.Shadedregionshows

1

˙
erroraroundthemean.Powerisinunitsofm
2
/s
4
.
Figure10.
Real-spacedivergencews(inunitsof10

5
s

1
)formode-couplinginversionthroughSOLAusingf-fcoupling,
andLCT,bandpassaround
qR

=100.Wecutedgesoutfromthewmapsandcompareacircularregionofdiameter
ˇ
175Mm.Thescatterplotshowstheagreementbetweenthemaps.Theslopesoftheblinethroughthescatterplotis
1.05.Fordemonstration,weshowinversionsonlyforpoloidalwusingSOLA.
DeRosa,M.,Duvall,T.L.,J.,&Toomre,J.2000,SoPh,
192,351,doi:
10.1023/A:1005269001739
DeRosa,M.L.,&Toomre,J.2004,ApJ,616,1242,
doi:
10.1086/424920
Duvall,T.L.,J.,&Harvey,J.W.1986,inNATOAdvanced
StudyInstitute(ASI)SeriesC,Vol.169,Seismologyof
theSunandtheDistantStars,ed.D.O.Gough,105{116
Duvall,T.L.,J.,S.M.,Harvey,J.W.,&
Pomerantz,M.A.1993,Nature,362,430,
doi:
10.1038/362430a0
Fisher,G.H.,&Welsch,B.T.2008,inAstronomical
SocietyofthePConferenceSeries,Vol.383,
SubsurfaceandAtmosphericonSolarActivity,
ed.R.Howe,R.W.Komm,K.S.Balasubramaniam,&
G.J.D.Petrie,373.
https://arxiv.org/abs/0712.4289
Giles,P.M.,Duvall,T.L.,Scherrer,P.H.,&Bogart,R.S.
1997,Nature,390,52,doi:
10.1038/36294
Gizon,L.,&Birch,A.C.2004,ApJ,614,472,
doi:
10.1086/423367
Gizon,L.,Cameron,R.H.,Pourabdian,M.,etal.2020,
Science,368,1469,doi:
10.1126/science.aaz7119
Gizon,L.,Cameron,R.H.,Bekki,Y.,etal.2021,A&A,
652,L6,doi:
10.1051/0004-6361/202141462
Greer,B.J.,Hindman,B.W.,&Toomre,J.2016,ApJ,
824,128,doi:
10.3847/0004-637X/824/2/128
Hanasoge,S.,&Mandal,K.2019,ApJL,871,L32,
doi:
10.3847/2041-
Hanasoge,S.M.,Hotta,H.,&Sreenivasan,K.R.2020,
ScienceAdvances,6,eaba9639,
doi:
10.1126/sciadv.aba9639
Hanasoge,S.M.,Woodard,M.,Antia,H.M.,Gizon,L.,&
Sreenivasan,K.R.2017,MNRAS,470,1404,
doi:
10.1093/mnras/stx1298
Hansen,P.C.1992,SIAMreview,34,561
Hanson,C.S.,Duvall,T.L.,Birch,A.C.,Gizon,L.,&
Sreenivasan,K.R.2020,A&A,644,A103,
doi:
10.1051/0004-6361/202039108
Hanson,C.S.,Hanasoge,S.,&Sreenivasan,K.R.2021,
ApJ,910,156,doi:
10.3847/1538-4357/abe770
Hathaway,D.H.,Teil,T.,Norton,A.A.,&Kitiashvili,I.
2015,ApJ,811,105,doi:
10.1088/0004-637X/811/2/105
16
Manietal.
Hathaway,D.H.,Upton,L.,&Colegrove,O.2013,Science,
342,1217,doi:
10.1126/science.1244682
Hill,F.1988,ApJ,333,996,doi:
10.1086/166807
Kashyap,S.G.,Das,S.B.,Hanasoge,S.M.,Woodard,
M.F.,&Tromp,J.2021,ApJS,253,47,
doi:
10.3847/1538-4365/abdf5e
Korda,D.,&

Svanda,M.2021,A&A,646,A184,
doi:
10.1051/0004-6361/202039928
Langfellner,J.,Birch,A.C.,&Gizon,L.2018,A&A,617,
A97,doi:
10.1051/0004-6361/201732471
Langfellner,J.,Gizon,L.,&Birch,A.C.2015,A&A,581,
A67,doi:
10.1051/0004-6361/201526024
Lavely,E.M.,&Ritzwoller,M.H.1992,Philosophical
TransactionsoftheRoyalSocietyofLondonSeriesA,
339,431,doi:
10.1098/rsta.1992.0048
Lindsey,C.,&Braun,D.C.2000,SoPh,192,261,
doi:
10.1023/A:1005227200911
optien,B.,Birch,A.C.,Duvall,T.L.,Gizon,L.,&
Schou,J.2016,A&A,587,A9,
doi:
10.1051/0004-6361/201526805
optien,B.,Gizon,L.,Birch,A.C.,etal.2018,Nature
Astronomy,2,568,doi:
10.1038/s41550-018-0460-x
Mandal,K.,&Hanasoge,S.2020,ApJ,891,125,
doi:
10.3847/1538-4357/ab7227
Mandal,K.,Hanasoge,S.M.,&Gizon,L.2021,A&A,652,
A96,doi:
10.1051/0004-6361/202141044
Mani,P.,&Hanasoge,S.2020,ApJ,901,139,
doi:
10.3847/1538-4357/abb133
|.2021,ApJ,920,36,doi:
10.3847/1538-4357/ac1ad6
November,L.J.,&Simon,G.W.1988,ApJ,333,427,
doi:
10.1086/166758
Pijpers,F.P.,&Thompson,M.J.1994,A&A,281,231
Rieutord,M.,Roudier,T.,Ludwig,H.G.,Nordlund,

A.,&
Stein,R.2001,A&A,377,L14,
doi:
10.1051/0004-6361:20011160
Rincon,F.,&Rieutord,M.2018,LivingReviewsinSolar
Physics,15,6,doi:
10.1007/s41116-018-0013-5
Rincon,F.,Roudier,T.,Schekochihin,A.A.,&Rieutord,
M.2017,A&A,599,A69,
doi:
10.1051/0004-6361/201629747
Schad,A.,&Roth,M.2020,ApJ,890,32,
doi:
10.3847/1538-4357/ab65ec
Scherrer,P.H.,Schou,J.,Bush,R.I.,etal.2012,SoPh,
275,207,doi:
10.1007/s11207-011-9834-2
Schou,J.,Antia,H.M.,Basu,S.,etal.1998,ApJ,505,
390,doi:
10.1086/306146
Sekii,T.1997,inSoundingSolarandStellarInteriors,ed.
J.Provost&F.-X.Schmider,Vol.181,ISBN0792348389
Sekii,T.,Kosovichev,A.G.,Zhao,J.,etal.2007,PASJ,
59,S637,doi:
10.1093/pasj/59.sp3.S637
Snodgrass,H.B.1984,SoPh,94,13,
doi:
10.1007/BF00154804
Thompson,M.J.,Toomre,J.,Anderson,E.R.,etal.1996,
Science,272,1300,doi:
10.1126/science.272.5266.1300
Unno,W.,Osaki,Y.,Ando,H.,Saio,H.,&Shibahashi,H.
1989,Nonradialoscillationsofstars
Verma,M.,M.,&Denker,C.2013,A&A,555,
A136,doi:
10.1051/0004-6361/201321628
Vorontsov,S.V.2011,MNRAS,418,1146,
doi:
10.1111/j.1365-2966.2011.19564.x
Woodard,M.2014,SoPh,289,1085,
doi:
10.1007/s11207-013-0386-5
Woodard,M.,Schou,J.,Birch,A.C.,&Larson,T.P.
2013,SoPh,287,129,doi:
10.1007/s11207-012-0075-9
Woodard,M.F.1989,ApJ,347,1176,doi:
10.1086/168206
|.2006,ApJ,649,1140,doi:
10.1086/506927
|.2007,ApJ,668,1189,doi:
10.1086/521391
|.2016,MNRAS,460,3292,doi:
10.1093/mnras/stw1223
Zhao,J.,Georgobiani,D.,Kosovichev,A.G.,etal.2007,
ApJ,659,848,doi:
10.1086/512009
Zhao,J.,Nagashima,K.,Bogart,R.S.,Kosovichev,A.G.,
&Duvall,T.L.,J.2012,ApJL,749,L5,
doi:
10.1088/2041-8205/749/1/L5
